---
title: "Quickstart to arcpy"
author: "Michael Koohafkan"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Quickstart}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---

```{r}
knitr::opts_chunk$set(echo = TRUE)
```

Getting started with `arcpy` in R is easy. If you're using ArcGIS Pro,
you'll first need to create a Conda environment that will link to your
ArcGIS Pro install. For example, here's how you would create a Conda
environment to link to an ArcGIS Pro 3.0 install (note that ArcGIS Pro
3.0 uses Python 3.9).

```{r eval = FALSE}
library(arcpy)

create_arcpy_env("r-arcpy", arcgis_version = "3.0", python_version = "3.9")
```

There is no good way for R to query the installed version of ArcGIS 
Pro, or to get the Python version that the ArcGIS Pro install uses,
so you'll have to provide this info.

Once you've created the environment, you can call `use_arcpy()` 
to connect to that environment.

```{r eval = FALSE}
use_arcpy("r-arcpy")
```

```{r echo = FALSE}
use_arcpy("r-arcpy")
```


If you are using ArcGIS Desktop, you'll need to pass the path to the
ArcGIS Desktop Python Binaries instead of a Conda environment name.
You can set the default Conda environment/binary path via the option
`arcpy.env` in your .Rprofile.

```
{r}
options(arcpy.env = "r-arcpy")
```

The `arcpy` package automatically provides a `reticulate` module object 
called `arcpy`. This object provides the interface to ArcGIS.

```{r}
arcpy
arcpy$GetInstallInfo()$ProductName
```

Once you are connected to your ArcGIS installation, using `arcpy` functions
and classes is as seamless as using any other Python module via `reticulate`.
The `arcpy` pacakge also re-exports reticulate's `py_help` function so that 
you can access the `arcpy` documentation.


```{r eval = FALSE}
# get and set the arcpy environment
arcpy$env$workspace = tempdir()
arcpy$env$workspace

# get help on arcpy functions
py_help(arcpy$Exists)
```

```{r echo = FALSE}
# get and set the arcpy environment
arcpy$env$workspace = tempdir()
arcpy$env$workspace
```


Happy scripting!
